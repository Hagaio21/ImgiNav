# Phase 1.3: Loss Tuning - Experiment F1
# RGB only (MSE=1.0, Seg=0.0, Cls=0.0)
# NOTE: Update all architecture params based on Phase 1.2 winner

experiment:
  name: "phase1_3_AE_F1_rgb_only"
  phase: "phase1_3_loss_tuning"
  save_path: "/work3/s233249/ImgiNav/experiments/phase1/phase1_3_AE_F1_rgb_only"

dataset:
  manifest: "/work3/s233249/ImgiNav/datasets/layouts.csv"
  outputs:
    rgb: "layout_path"
    segmentation: "layout_path"
    label: "type"
  filters:
    is_empty: [false]
  return_path: false

autoencoder:
  encoder:
    in_channels: 3
    latent_channels: 8  # TODO: Update based on Phase 1.2 winner
    base_channels: 32  # TODO: Update based on Phase 1.2 winner
    downsampling_steps: 4  # TODO: Update based on Phase 1.2 winner
    activation: SiLU
    norm_groups: 8
    variational: false  # TODO: Update based on Phase 1.2 winner
  
  decoder:
    latent_channels: 8  # TODO: Update based on Phase 1.2 winner
    base_channels: 32  # TODO: Update based on Phase 1.2 winner
    upsampling_steps: 4  # TODO: Update based on Phase 1.2 winner
    activation: SiLU
    norm_groups: 8
    heads:
      - type: RGBHead
        name: rgb
        out_channels: 3
        final_activation: tanh
      - type: SegmentationHead
        name: segmentation
        num_classes: 10
      - type: ClassificationHead
        name: classification
        num_classes: 2

training:
  seed: 42
  train_split: 0.8
  split_seed: 42
  batch_size: 16
  num_workers: 8
  shuffle: true
  epochs: 10  # Quick test
  learning_rate: 0.0001
  optimizer: AdamW
  weight_decay: 0.01
  save_interval: 5
  sample_interval: 5
  early_stopping_patience: 3
  early_stopping_min_delta: 0.0001
  early_stopping_restore_best: true
  
  loss:
    type: CompositeLoss
    losses:
      - type: MSELoss
        key: rgb
        target: rgb
        weight: 1.0
      - type: CrossEntropyLoss
        key: segmentation
        target: segmentation
        weight: 0.0  # Disabled
      - type: CrossEntropyLoss
        key: classification
        target: label
        weight: 0.0  # Disabled

